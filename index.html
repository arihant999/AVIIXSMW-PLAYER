<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AVIIXSMW — Dual Player</title>
  <meta name="theme-color" content="#0f172a" />
  <style>
    :root{
      --bg:#0b0f1a; --card:#111827; --muted:#94a3b8; --text:#e5e7eb; --accent:#22d3ee; --accent-2:#60a5fa;
      --border:#1f2937; --shadow:0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif;background:linear-gradient(180deg,#0b0f1a,#0b1220);color:var(--text)}
    .wrap{display:flex;flex-direction:column;height:100%}
    .topbar{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;border-bottom:1px solid var(--border);background:linear-gradient(180deg,#0b1324,#0a1020)}
    .logo{display:flex;align-items:center;gap:.6rem;font-weight:700;letter-spacing:.5px}
    .logo-img{width:36px;height:36px;border-radius:10px;object-fit:cover;box-shadow:0 0 24px rgba(34,211,238,.45)}
    .sp{flex:1}
    .controls{display:flex;flex-wrap:wrap;gap:.5rem}
    .btn{appearance:none;border:1px solid var(--border);background:#0b1220;color:var(--text);padding:.5rem .75rem;border-radius:.8rem;cursor:pointer;box-shadow:var(--shadow);transition:.2s ease; font-weight:600}
    .btn:hover{transform:translateY(-1px);border-color:#2a3648}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .sel{appearance:none;background:#0b1220;border:1px solid var(--border);color:var(--text);padding:.5rem .75rem;border-radius:.6rem}.main{display:flex;flex:1;min-height:0}
.pane{position:relative;flex:1;min-width:200px;min-height:120px;border-right:1px solid var(--border)}
.pane:last-child{border-right:none}
.pane h3{margin:.5rem .75rem;font-size:.9rem;color:var(--muted);font-weight:600}
video{width:100%;height:calc(100% - 2.4rem);background:#000;display:block}
iframe.pdf{width:100%;height:calc(100% - 2.4rem);background:#0a0a0a;border:0}

.divider{width:9px;background:linear-gradient(180deg,#0e1629,#0b1220);cursor:col-resize;display:flex;align-items:center;justify-content:center}
.divider::after{content:"";width:3px;height:46px;border-radius:2px;background:#1f2a42}

.vidbar{position:absolute;left:.6rem;bottom:.8rem;right:.6rem;display:flex;gap:.5rem;align-items:center;justify-content:space-between;pointer-events:none}
.vidbar .group{display:flex;gap:.4rem;pointer-events:auto}
.chip{font-size:.85rem;border:1px solid var(--border);background:rgba(10,17,30,.85);backdrop-filter:blur(6px);padding:.35rem .6rem;border-radius:.7rem}
.chip b{opacity:.8}

.kbd{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:.78rem;border:1px solid var(--border);padding:.15rem .38rem;border-radius:.4rem;background:#0d1426;color:#cbd5e1}

.helper{padding:.5rem 1rem;border-top:1px solid var(--border);color:var(--muted);font-size:.9rem;display:flex;gap:1rem;flex-wrap:wrap;align-items:center}

.alert{padding:.65rem .8rem;margin:.5rem 1rem;border:1px dashed #334155;border-radius:.8rem;background:#0b1220}
.hide{display:none}
@media (max-width: 980px){
  .main{flex-direction:column}
  .divider{height:9px;width:auto;cursor:row-resize}
  .pane{border-right:none;border-bottom:1px solid var(--border)}
  .pane:last-child{border-bottom:none}
}

  </style>
</head>
<body>
<div class="wrap">
  <header class="topbar">
    <div class="logo" title="AVIIXSMW">
      <img id="logoImg" class="logo-img" src="logo.png" alt="AVIIXSMW" />
      <span>AVIIXSMW — Dual Player</span>
    </div>
    <div class="sp"></div>
    <div class="controls">
      <button id="swapBtn" class="btn" title="Swap panes">Swap</button>
      <button id="openPdfBtn" class="btn" title="Open PDF in new tab">Open PDF</button>
      <select id="speedSel" class="sel" title="Playback speed">
        <option value="0.5">0.5×</option>
        <option value="0.75">0.75×</option>
        <option value="1" selected>1.0×</option>
        <option value="1.25">1.25×</option>
        <option value="1.5">1.5×</option>
        <option value="1.75">1.75×</option>
        <option value="2">2.0×</option>
      </select>
      <button id="back10" class="btn" title="Back 10s">⟲ 10s</button>
      <button id="fwd10" class="btn" title="Forward 10s">10s ⟳</button>
      <button id="pipBtn" class="btn" title="Picture-in-Picture">PiP</button>
      <button id="fsBtn" class="btn" title="Fullscreen">Fullscreen</button>
    </div>
  </header>  <div id="corsNote" class="alert hide">⚠️ If the PDF doesn't load here, it may be blocked by its server. Use <b>Open PDF</b> to view it in a new tab.</div>  <section class="main" id="main">
    <div class="pane" id="leftPane">
      <h3>Lecture</h3>
      <video id="player" controls playsinline preload="metadata"></video>
      <div class="vidbar">
        <div class="group">
          <span class="chip"><b>J</b>=−10s</span>
          <span class="chip"><b>L</b>=+10s</span>
          <span class="chip"><b>K</b>=Play/Pause</span>
        </div>
        <div class="group">
          <span class="chip" id="timeChip">00:00 / 00:00</span>
        </div>
      </div>
    </div><div class="divider" id="divider"></div>

<div class="pane" id="rightPane">
  <h3>Slides / PDF</h3>
  <iframe id="pdfFrame" class="pdf" title="Slides PDF"></iframe>
</div>

  </section>  <div class="helper">
    Paste URLs via query string: <span class="kbd">?playurl=...&pdf=...&logo=...</span> • Example sources may require you to press <b>Play</b> due to browser autoplay rules.
  </div>
</div><script>
(function(){
  const qs = new URLSearchParams(location.search);
  const playUrl = qs.get('playurl') || qs.get('video') || '';
  const pdfUrl  = qs.get('pdf')     || '';
  const logoUrl = qs.get('logo')    || '';

  const video = document.getElementById('player');
  const pdf   = document.getElementById('pdfFrame');
  const speedSel = document.getElementById('speedSel');
  const back10 = document.getElementById('back10');
  const fwd10  = document.getElementById('fwd10');
  const pipBtn = document.getElementById('pipBtn');
  const fsBtn  = document.getElementById('fsBtn');
  const swapBtn= document.getElementById('swapBtn');
  const openPdfBtn = document.getElementById('openPdfBtn');
  const timeChip = document.getElementById('timeChip');
  const corsNote = document.getElementById('corsNote');
  const logoImg  = document.getElementById('logoImg');

  // Set logo from query param if provided
  if(logoUrl){ logoImg.src = logoUrl; }

  // Load sources
  if(playUrl){ video.src = playUrl; }
  if(pdfUrl){ 
    // Try to embed directly; if the server blocks framing, provide a helpful note.
    pdf.src = pdfUrl + (pdfUrl.includes('#')? '' : '#toolbar=1&navpanes=0');
    // Attempt to detect X-Frame-Options denial (best-effort)
    setTimeout(()=>{
      try{ const x = pdf.contentWindow.location.href; }catch(e){ corsNote.classList.remove('hide'); }
    }, 1200);
  }

  // Speed control
  speedSel.addEventListener('change', ()=>{ video.playbackRate = parseFloat(speedSel.value); });

  // Skip controls
  function skip(sec){
    try{ video.currentTime = Math.max(0, Math.min((video.duration||1e9), video.currentTime + sec)); }catch(e){}
  }
  back10.addEventListener('click', ()=> skip(-10));
  fwd10.addEventListener('click',  ()=> skip(10));

  // Keyboard shortcuts: J/L/K like YouTube
  document.addEventListener('keydown', (e)=>{
    if(['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) return;
    if(e.key.toLowerCase()==='j'){ skip(-10); }
    if(e.key.toLowerCase()==='l'){ skip(10); }
    if(e.key.toLowerCase()==='k' || e.code==='Space'){ e.preventDefault(); video.paused?video.play():video.pause(); }
  });

  // Time chip
  function fmt(t){ if(!isFinite(t)) return '00:00'; const m=Math.floor(t/60), s=Math.floor(t%60); return String(m).padStart(2,'0')+":"+String(s).padStart(2,'0'); }
  function updateTime(){ timeChip.textContent = `${fmt(video.currentTime)} / ${fmt(video.duration)}`; }
  ['timeupdate','durationchange','loadedmetadata'].forEach(ev=>video.addEventListener(ev,updateTime));

  // Picture-in-Picture
  async function togglePiP(){
    try{
      if(document.pictureInPictureElement){ await document.exitPictureInPicture(); return; }
      // Some browsers require the video to be playing for PiP
      if(video.paused) await video.play().catch(()=>{});
      await video.requestPictureInPicture();
    }catch(err){ alert('PiP not available in this browser.'); }
  }
  pipBtn.addEventListener('click', togglePiP);
  if(!('pictureInPictureEnabled' in document)) pipBtn.disabled = true;

  // Fullscreen
  fsBtn.addEventListener('click', ()=>{
    const root = document.documentElement;
    if(document.fullscreenElement){ document.exitFullscreen(); }
    else{ root.requestFullscreen && root.requestFullscreen(); }
  });

  // Open PDF externally
  openPdfBtn.addEventListener('click', ()=>{ if(pdfUrl) window.open(pdfUrl, '_blank'); });

  // Swap panes
  swapBtn.addEventListener('click', ()=>{
    const main = document.getElementById('main');
    const left = document.getElementById('leftPane');
    const right= document.getElementById('rightPane');
    if(main.firstElementChild === left){ main.insertBefore(right, left); } else { main.insertBefore(left, right); }
  });

  // Resizable divider (horizontal or vertical based on layout)
  const divider = document.getElementById('divider');
  const leftPane = document.getElementById('leftPane');
  const rightPane = document.getElementById('rightPane');
  let dragging=false;
  let verticalMode = window.matchMedia('(max-width: 980px)').matches; // true => stacked

  function setSizes(px){
    const rect = document.getElementById('main').getBoundingClientRect();
    if(!verticalMode){
      const leftW = Math.min(rect.width-120, Math.max(240, px - rect.left));
      leftPane.style.flex = '0 0 ' + leftW + 'px';
      rightPane.style.flex = '1 1 auto';
    }else{
      const topH = Math.min(rect.height-120, Math.max(160, px - rect.top));
      leftPane.style.flex = '0 0 ' + topH + 'px';
      rightPane.style.flex = '1 1 auto';
    }
  }

  function updateMode(){ verticalMode = window.matchMedia('(max-width: 980px)').matches; leftPane.style.flex='1 1 auto'; rightPane.style.flex='1 1 auto'; }
  window.addEventListener('resize', updateMode);

  divider.addEventListener('mousedown', (e)=>{ dragging=true; document.body.style.userSelect='none'; });
  window.addEventListener('mouseup', ()=>{ dragging=false; document.body.style.userSelect=''; });
  window.addEventListener('mousemove', (e)=>{ if(dragging) setSizes(verticalMode? e.clientY : e.clientX); });

  // Touch support
  divider.addEventListener('touchstart', ()=>{ dragging=true; }, {passive:true});
  window.addEventListener('touchend', ()=>{ dragging=false; });
  window.addEventListener('touchmove', (e)=>{ if(dragging){ const t=e.touches[0]; setSizes(verticalMode? t.clientY : t.clientX); } }, {passive:true});

  // Autoplay hint on mobile (some sources block)
  video.addEventListener('play', ()=>{ speedSel.value = String(video.playbackRate || 1); });
})();
</script></body>
</html>
